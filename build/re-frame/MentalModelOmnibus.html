
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Mental Model Omnibus Â· re-frame</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="API.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">description: re-frame official documentation</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Derived Values, Flowing</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../">
            
                <a href="../">
            
                    
                    This Repo's README
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="ApplicationState.html">
            
                <a href="ApplicationState.html">
            
                    
                    app-db (Application State)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="CodeWalkthrough.html">
            
                <a href="CodeWalkthrough.html">
            
                    
                    First Code Walk-Through
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="API.html">
            
                <a href="API.html">
            
                    
                    The API
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.5" data-path="MentalModelOmnibus.html">
            
                <a href="MentalModelOmnibus.html">
            
                    
                    Mental Model Omnibus
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Alternative Introductions</li>
        
        
    
        <li class="chapter " data-level="3.1" >
            
                <a target="_blank" href="https://purelyfunctional.tv/guide/re-frame-building-blocks/">
            
                    
                    purelyfunctional.tv
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" >
            
                <a target="_blank" href="https://lambdaisland.com/episodes">
            
                    
                    Lambda Island Videos
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Dominoes 2 and 3 - Event Handlers</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="EventHandlingInfographic.html">
            
                <a href="EventHandlingInfographic.html">
            
                    
                    Infographic Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="EffectfulHandlers.html">
            
                <a href="EffectfulHandlers.html">
            
                    
                    Effectful Handlers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="Interceptors.html">
            
                <a href="Interceptors.html">
            
                    
                    Interceptors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="Effects.html">
            
                <a href="Effects.html">
            
                    
                    Effects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="Coeffects.html">
            
                <a href="Coeffects.html">
            
                    
                    Coeffects
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Domino 4 - Subscriptions</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="SubscriptionInfographic.html">
            
                <a href="SubscriptionInfographic.html">
            
                    
                    Infographic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="SubscriptionsCleanup.html">
            
                <a href="SubscriptionsCleanup.html">
            
                    
                    Correcting a wrong
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="SubscriptionFlow.html">
            
                <a href="SubscriptionFlow.html">
            
                    
                    Flow Mechanics
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Domino 5 - Reagent Tutorials</li>
        
        
    
        <li class="chapter " data-level="6.1" >
            
                <a target="_blank" href="https://github.com/Day8/re-frame/wiki#reagent-tutorials">
            
                    
                    The Basics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" >
            
                <a target="_blank" href="https://lambdaisland.com/episodes">
            
                    
                    Lambda Island Videos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" >
            
                <a target="_blank" href="https://purelyfunctional.tv/guide/reagent/">
            
                    
                    purelyfunctional.tv 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4" >
            
                <a target="_blank" href="http://timothypratley.blogspot.com.au/p/p.html">
            
                    
                    Reagent Deep Dive Series from Timothy Pratley
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.5" >
            
                <a target="_blank" href="https://www.martinklepsch.org/posts/props-children-and-component-lifecycle-in-reagent.html">
            
                    
                    Props, Children & Component Lifecycle
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">App Structure</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="Basic-App-Structure.html">
            
                <a href="Basic-App-Structure.html">
            
                    
                    Basic App Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="Navigation.html">
            
                <a href="Navigation.html">
            
                    
                    Navigation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="Namespaced-Keywords.html">
            
                <a href="Namespaced-Keywords.html">
            
                    
                    Namespaced Keywords
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">App Data</li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="Loading-Initial-Data.html">
            
                <a href="Loading-Initial-Data.html">
            
                    
                    Loading Initial Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="Talking-To-Servers.html">
            
                <a href="Talking-To-Servers.html">
            
                    
                    Talking To Servers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="Subscribing-To-External-Data.html">
            
                <a href="Subscribing-To-External-Data.html">
            
                    
                    Subscribing to External Data
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Debugging And Testing</li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="Debugging-Event-Handlers.html">
            
                <a href="Debugging-Event-Handlers.html">
            
                    
                    Debugging Event Handlers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="Debugging.html">
            
                <a href="Debugging.html">
            
                    
                    Debugging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="Testing.html">
            
                <a href="Testing.html">
            
                    
                    Testing
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Miscellaneous</li>
        
        
    
        <li class="chapter " data-level="10.1" data-path="FAQs/">
            
                <a href="FAQs/">
            
                    
                    FAQs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.2" data-path="External-Resources.html">
            
                <a href="External-Resources.html">
            
                    
                    External Resources
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.3" data-path="Performance-Problems.html">
            
                <a href="Performance-Problems.html">
            
                    
                    Eek! Performance Problems
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.4" data-path="Solve-the-CPU-hog-problem.html">
            
                <a href="Solve-the-CPU-hog-problem.html">
            
                    
                    Solve the CPU hog problem
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.5" data-path="Using-Stateful-JS-Components.html">
            
                <a href="Using-Stateful-JS-Components.html">
            
                    
                    Using Stateful JS Components
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.6" data-path="The-re-frame-logo.html">
            
                <a href="The-re-frame-logo.html">
            
                    
                    The re-frame Logo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.7" data-path="Code-Of-Conduct.html">
            
                <a href="Code-Of-Conduct.html">
            
                    
                    Code Of Conduct
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Mental Model Omnibus</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <blockquote>
<p>In a rush? You can skip this tutorial page on a first pass. <br>
It is quite abstract and it won&apos;t directly help you write re-frame code. 
On the other hand, it will considerably deepen your understanding 
of what re-frame is about, so remember to cycle back and read it later.<br>
Next page: <a href="EffectfulHandlers.html">Effectful Handlers</a></p>
</blockquote>
<h2 id="mental-model-omnibus">Mental Model Omnibus</h2>
<p><img height="450px" align="right" src="images/mental-model-omnibus.jpg?raw=true"></p>
<blockquote>
<p>All models are wrong, but some are useful</p>
</blockquote>
<p>The re-frame tutorials initially focus on the <strong>domino
narrative</strong>. The goal is to efficiently explain the mechanics of re-frame,
and to get you reading and writing code ASAP.</p>
<p>But <strong>there are other perspectives</strong> on re-frame
which will deepen your understanding.</p>
<p>This tutorial is a tour of these ideas, justifications and insights.<br>It is a little rambling, but I&apos;m hoping it will deliver for you
at least one &quot;Aaaah, I see&quot; moment before the end.</p>
<blockquote>
<p>If a factory is torn down but the rationality which produced it is
left standing, then that rationality will simply produce another
factory. If a revolution destroys a government, but the systematic
patterns of thought that produced that government are left intact,
then those patterns will repeat themselves. <br>
-- Robert Pirsig, Zen and the Art of Motorcycle Maintenance</p>
</blockquote>
<h2 id="what-is-the-problem">What is the problem?</h2>
<p>First, we decided to build our SPA apps with ClojureScript, then we
chose <a href="http://reagent-project.github.io/" target="_blank">Reagent</a>, then we had a problem. It was mid 2014.</p>
<p>For all its considerable brilliance,  Reagent (+ React)
delivers only the &apos;V&apos; part of a traditional MVC framework.</p>
<p>But apps involve much more than V. We build quite complicated
SPAs which can run to 50K lines of code. So, I wanted to know:
where does the control logic go? How is state stored &amp; manipulated? etc.</p>
<p>We read up on <a href="https://github.com/pedestal/pedestal-app" target="_blank">Pedestal App</a>, <a href="http://facebook.github.io/flux/docs/overview.html#content" target="_blank">Flux</a>,
<a href="http://hoplon.io/" target="_blank">Hoplon</a>, <a href="https://github.com/swannodette/om" target="_blank">Om</a>, early <a href="http://elm-lang.org/" target="_blank">Elm</a>, etc., and re-frame is the architecture that
emerged.  Since then, we&apos;ve tried to keep an eye on further developments like the
Elm Architecture, Om.Next, BEST, Cycle.js, Redux, etc.  They have taught us much
although we have often made different choices.</p>
<p>re-frame does have parts which correspond to M, V, and C, but they aren&apos;t objects.
It is sufficiently different in nature
from (traditional, Smalltalk) MVC that calling it MVC would be confusing.  I&apos;d
love an alternative.</p>
<p>Perhaps it is a RAVES framework - Reactive-Atom Views Event
Subscription framework (I love the smell of acronym in the morning).</p>
<p>Or, if we distill to pure essence, <code>DDATWD</code> - Derived Data All The Way Down.</p>
<p><em>TODO:</em> get acronym down to 3 chars! Get an image of stacked Turtles for <code>DDATWD</code>
insider&apos;s joke, conference T-Shirt.</p>
<h2 id="guiding-philosophy">Guiding Philosophy</h2>
<p><strong>First</strong>, above all, we believe in the one true <a href="https://twitter.com/holmsand" target="_blank">Dan Holmsand</a>, creator of Reagent, and
his divine instrument: the <code>ratom</code>.  We genuflect towards Sweden once a day.</p>
<p><strong>Second</strong>, we believe in ClojureScript, immutable data and the process of building
a system out of pure functions.</p>
<p><strong>Third</strong>, we believe in the primacy of data, for the reasons described in
the main README. re-frame has a data oriented, functional architecture.</p>
<p><strong>Fourth</strong>, we believe that Reactive Programming is one honking good idea.
How did we ever live without it? It is a quite beautiful solution to one half of re-frame&apos;s
data conveyance needs, <strong>but</strong> we&apos;re cautious about taking it too far - as far as, say, cycle.js.
It doesn&apos;t take over everything in re-frame - it just does part of the job.</p>
<p><strong>Finally</strong>, a long time ago in a galaxy far far away, I was lucky enough to program in Eiffel
where I was exposed to the idea of <a href="https://en.wikipedia.org/wiki/Command%E2%80%93query_separation" target="_blank">command-query separation</a>.
The modern rendering of this idea is CQRS (<a href="http://www.baeldung.com/cqrs-event-sourced-architecture-resources" target="_blank">see resources here</a>).
But, even today, we still see read/write <code>cursors</code> and two-way data binding being promoted as a good thing.
Please, just say no. We already know where that goes. As your programs get bigger, the use of these two-way constructs
will encourage control logic into all the
wrong places and you&apos;ll end up with a tire-fire of an Architecture. <br>
Sincerely, The Self-appointed President of the Cursor Skeptic&apos;s Society.</p>
<h2 id="on-dsls-and-machines">On DSLs and Machines</h2>
<p><code>Events</code> are cardinal to re-frame - they&apos;re a fundamental organising principle. </p>
<p>Each re-frame app will have a different set of <code>events</code> and your job is
to design exactly the right ones for any given app you build. These <code>events</code> 
will model &quot;intent&quot; - generally the user&apos;s.  They will be the 
&quot;language of the system&quot; and will provide the eloquence.</p>
<p>And they are data.</p>
<p>Imagine we created a drawing application. And then we allowed 
someone to use our application and, as they did, we captured, 
into a collection, the events caused by that user&apos;s actions 
(button clicks, drags, key presses, etc).</p>
<p>The collection of events might look like this:  </p>
<pre><code class="lang-cljs">(def collected-events
  [
     [:clear]
     [:new :triangle 1 2 3]
     [:select-object 23]
     [:rename &quot;a better name&quot;]
     [:delete-selection]
     ....
  ])
</code></pre>
<p>Now, as an aside, consider the following assembly instructions:</p>
<pre><code class="lang-asm">mov eax, ebx
sub eax, 216
mov BYTE PTR [ebx], 2
</code></pre>
<p>Assembly instructions are represented as data, right?  Data which 
happens to be &quot;executable&quot; by the right machine - an x86 machine in the case above.</p>
<p>I&apos;d like you to now look back at that collection of events and view it in the 
same way - data instructions which can be executed - by the right machine.</p>
<p>Wait. What machine?  Well, the Event Handlers you register collectively implement 
the &quot;machine&quot; on which these instructions execute. When you register 
a new event handler using <code>reg-event-db</code>, 
it is like you are adding to the &quot;instruction set&quot; of the &quot;machine&quot;.</p>
<p>In re-frame&apos;s README, near the top, I claimed that it had a 
Data Oriented Design. Typically, that claim means you &quot;program&quot; in a data
structure of a certain format (Domain specific language), 
which is then &quot;executed&quot; by an interpreter.</p>
<p>Take hiccup as an example. It is a DSL for describing DOM. 
You program by supplying a data structure in a particular, 
known format (the DSL) and Reagent acts as the 
&quot;interpreter&quot; which executes that &quot;language&quot;:  </p>
<pre><code>[:div {:font-size 12} &quot;Hello&quot;]  ;; a data structure
</code></pre><p>Back to re-frame. It requires that YOU design events which
combine into a DSL for your app
and, at the same time, it asks YOU to provide an interpreter for
each instruction in that DSL. When your re-frame application runs, 
it is just executing a &quot;program&quot; (collection of events) 
dynamically created by the user&apos;s event-causing actions.</p>
<p>In summary: </p>
<ul>
<li>Events are the assembly language of your app. </li>
<li>These instructions collectively form a Domain Specific Language (DSL). The language of your system.</li>
<li>These instructions are data. </li>
<li>One instruction after another gets executed by your functioning app.</li>
<li>The Event Handlers you register collectively implement the &quot;machine&quot; on which this DSL executes. </li>
</ul>
<p>On the subject of DSLs, watch James Reeves&apos; excellent talk (video): <a href="https://www.youtube.com/watch?v=zznwKCifC1A" target="_blank">Transparency through data</a> </p>
<h2 id="it-does-event-sourcing">It does Event Sourcing</h2>
<p>How did that error happen, you puzzle, shaking your head ruefully?
What did the user do immediately prior?  What
state was the app in that this event was so problematic?</p>
<p>To debug, you need to know this information:</p>
<ol>
<li>the state of the app immediately before the exception</li>
<li>What final <code>event</code> then caused your app to error</li>
</ol>
<p>Well, with re-frame you need to record (have available):</p>
<ol>
<li>A recent checkpoint of the application state in <code>app-db</code> (perhaps the initial state)</li>
<li>all the events <code>dispatch</code>ed since the last checkpoint, up to the point where the error occurred</li>
</ol>
<p>Note: that&apos;s all just data. <strong>Pure, lovely loggable data.</strong></p>
<p>If you have that data, then you can reproduce the error.</p>
<p>re-frame allows you to time travel, even in a production setting.
To find the bug, install the &quot;checkpoint&quot; state into <code>app-db</code>
and then &quot;play forward&quot; through the collection of dispatched events.</p>
<p>The only way the app &quot;moves forwards&quot; is via events. &quot;Replaying events&quot; moves you
step by step towards the error causing problem.</p>
<p>This is perfect for debugging assuming, of course, you are in a position to capture
a checkpoint of <code>app-db</code>, and the events since then.</p>
<p>Here&apos;s Martin Fowler&apos;s <a href="http://martinfowler.com/eaaDev/EventSourcing.html" target="_blank">description of Event Sourcing</a>.</p>
<h2 id="it-does-a-reduce">It does a reduce</h2>
<p>Here&apos;s an interesting way of thinking about the re-frame
data flow ...</p>
<p><strong>First</strong>, imagine that all the events ever dispatched in a
certain running app were stored in a collection (yes, event sourcing again).
So, if when the app started, the user clicked on button X
the first item in this collection would be the event
generated by that button, and then, if next the user moved
a slider, the associated event would be the next item in
the collection, and so on and so on. We&apos;d end up with a
collection of event vectors.</p>
<p><strong>Second</strong>, remind yourself that the <code>combining function</code>
of a <code>reduce</code> takes two arguments:</p>
<ol>
<li>the current state of the reduction and</li>
<li>the next collection member to fold in</li>
</ol>
<p>Then notice that <code>reg-event-db</code> event handlers take two arguments also:</p>
<ol>
<li><code>db</code> - the current state of <code>app-db</code></li>
<li><code>v</code> - the next event to fold in</li>
</ol>
<p>Interesting. That&apos;s the same as a <code>combining function</code> in a <code>reduce</code>!!</p>
<p>So, now we can introduce the new mental model:  at any point in time,
the value in <code>app-db</code> is the result of performing a <code>reduce</code> over
the entire <code>collection</code> of events dispatched in the app up until
that time. The combining function for this reduce is the set of event handlers.</p>
<p>It is almost like <code>app-db</code> is the temporary place where this
imagined <code>perpetual reduce</code> stores its on-going reduction.</p>
<p>Now, in the general case, this perspective breaks down a bit,
because of <code>reg-event-fx</code> (has <code>-fx</code> on the end, not <code>-db</code>) which
allows:</p>
<ol>
<li>Event handlers to produce <code>effects</code> beyond just application state
changes.</li>
<li>Event handlers to have <code>coeffects</code> (arguments) in addition to <code>db</code> and <code>v</code>.</li>
</ol>
<p>But, even if it isn&apos;t the full picture, it is a very useful
and interesting mental model. We were first exposed to this idea
via Elm&apos;s early use of <code>foldp</code> (fold from the past), which was later enshrined in the
Elm Architecture.</p>
<h2 id="derived-data-all-the-way-down">Derived Data All The Way Down</h2>
<p>For the love of all that is good, please watch this terrific
<a href="https://www.youtube.com/watch?v=fU9hR3kiOK0" target="_blank">StrangeLoop presentation</a> (40 mins).
See what happens when you re-imagine a database as a stream!! Look at
all the problems that evaporate.
Think about that: shared mutable state (the root of all evil),
re-imagined as a stream!!  Blew my socks off.</p>
<p>If, by chance, you ever watched that video (you should!), you might then twig to
the idea that <code>app-db</code> is really a derived value ... the video talks
a lot about derived values. So, yes, app-db is a derived value of the <code>perpetual reduce</code>.</p>
<p>And yet, it acts as the authoritative source of state in the app. And yet,
it isn&apos;t, it is simply a piece of derived state.  And yet, it is the source. Etc.</p>
<p>This is an infinite loop of sorts - an infinite loop of derived data.</p>
<h2 id="it-does-fsm">It does FSM</h2>
<blockquote>
<p>Any sufficiently complicated GUI contains an ad hoc,
informally-specified, bug-ridden, slow implementation
of a hierarchical Finite State Machine  <br>
-- me, trying too hard to impress my two twitter followers</p>
</blockquote>
<p><code>event handlers</code> collectively
implement the &quot;control&quot; part of an application. Their logic
interprets arriving events in the context of existing state,
and they compute the new state of the application.</p>
<p><code>events</code> act a bit like the <code>triggers</code> in a finite state machine, and
the <code>event handlers</code> act like the rules which govern how the state machine
moves from one logical state to the next.</p>
<p>In the simplest
case, <code>app-db</code> will contain a single value which represents the current &quot;logical state&quot;.
For example, there might be a single <code>:phase</code> key which can have values like <code>:loading</code>,
<code>:not-authenticated</code> <code>:waiting</code>, etc.  Or, the &quot;logical state&quot; could be a function
of many values in <code>app-db</code>.</p>
<p>Not every app has lots of logical states, but some do, and if you are implementing
one of them, then formally recognising it and using a technique like
<a href="https://www.amazon.com/Constructing-User-Interface-Statecharts-Horrocks/dp/0201342782" target="_blank">State Charts</a>
will help greatly in getting a clean design and fewer bugs.</p>
<p>The beauty of re-frame, from a FSM point of view, is that all the state is
in one place - unlike OO systems where the state is distributed (and synchronised) 
across many objects. So implementing your control logic as a FSM is
fairly natural in re-frame, whereas it is often difficult and
contrived in other kinds of architecture (in my experience).</p>
<p>So, members of the jury, I put it to you that:</p>
<ul>
<li>the first 3 dominoes implement an <a href="https://en.wikipedia.org/wiki/Event-driven_finite-state_machine" target="_blank">Event-driven finite-state machine</a></li>
<li>the last 3 dominoes render of the FSM&apos;s current state for the user to observe</li>
</ul>
<p>Depending on your app, this may or may not be a useful mental model,
but one thing is for sure ...</p>
<p>Events - that&apos;s the way we roll.</p>
<h2 id="interconnections">Interconnections</h2>
<p>Ask a Systems Theorist, and they&apos;ll tell you that a system has <strong>parts</strong> and <strong>interconnections</strong>.</p>
<p>Human brains tend to focus first on the <strong>parts</strong>, and then, later, maybe on
<strong>interconnections</strong>. But we know better, right? We
know interconnections are often critical to a system.
&quot;Focus on the lines between the boxes&quot; we lecture anyone kind enough to listen (in my case, glassy-eyed family members).</p>
<p>In the case of re-frame, dominoes are the <strong>parts</strong>, so, tick, yes, we have
looked at them first. Our brains are happy. But what about the <strong>interconnections</strong>?</p>
<p>If the <strong>parts</strong> are functions, as is the case with re-frame,
what does it even mean to talk about <strong>interconnections between functions?</strong>
To answer that question, I&apos;ll rephrase it as:
how are the domino functions <strong>composed</strong>?</p>
<p>At the language level,
Uncle Alonzo and Uncle John tell us how a function like <code>count</code> composes:   </p>
<pre><code class="lang-clj">(<span class="hljs-name"><span class="hljs-builtin-name">str</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">count</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">filter</span></span> odd?  [<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span>])))
</code></pre>
<p>We know when <code>count</code> is called, and with what
argument, and how the value it computes becomes the arg for a further function.
We know how data &quot;flows&quot; into and out of the functions.</p>
<p>Sometimes, we&apos;d rewrite this code as:</p>
<pre><code class="lang-clj">(<span class="hljs-name"><span class="hljs-builtin-name">-&gt;&gt;</span></span>  [<span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span>]
      (<span class="hljs-name"><span class="hljs-builtin-name">filter</span></span> odd?)
      count
      str)
</code></pre>
<p>With this arrangement, we talk of &quot;threading&quot; data
through functions. <strong>It seems to help our comprehension to conceive function
composition in terms of data flow</strong>.</p>
<p>re-frame delivers architecture
by supplying the interconnections - it threads the data - it composes the dominoes - it is the lines between the boxes.</p>
<p>But it doesn&apos;t have a universal method for this &quot;composition&quot;. The technique it uses varies from one domino
neighbour-pair to the next.  Initially, it uses a queue/router, then a pipeline of interceptors
and, finally, a Signal Graph.</p>
<p>Remember back in the original README?  Our analogy for re-frame was the water cycle - water flowing around the loop,
compelled by different kinds of forces at different times (gravity, convection, etc), going through phase changes.</p>
<p>With this focus on interconnections, we have been looking on the &quot;forces&quot;  part of the loop.  The transport.</p>
<h2 id="full-stack">Full Stack</h2>
<p>If you like re-frame and want to take the principles full-stack, then
these resources might be interesting to you:</p>
<p>Commander Pattern<br><a href="https://www.youtube.com/watch?v=B1-gS0oEtYc" target="_blank">https://www.youtube.com/watch?v=B1-gS0oEtYc</a></p>
<p>Datalog All The Way Down<br><a href="https://www.youtube.com/watch?v=aI0zVzzoK_E" target="_blank">https://www.youtube.com/watch?v=aI0zVzzoK_E</a></p>
<p>Reactive PostgreSQL:
<a href="https://yogthos.net/posts/2016-11-05-LuminusPostgresNotifications.html" target="_blank">https://yogthos.net/posts/2016-11-05-LuminusPostgresNotifications.html</a></p>
<h2 id="what-of-this-romance">What Of This Romance?</h2>
<p>My job is to be a relentless cheerleader for re-frame, right?
The gyrations of my Pom-Poms should be tectonic,
but the following quote makes me smile. It should
be taught in all ComSci courses.</p>
<blockquote>
<p>We begin in admiration and end by organizing our disappointment <br>
&#xA0;&#xA0;&#xA0; -- Gaston Bachelard (French philosopher)</p>
</blockquote>
<p>Of course, that only applies if you get passionate about a technology
(a flaw of mine).</p>
<p>But, no. No! Those French Philosophers and their pessimism - ignore him!!
Your love for re-frame will be deep, abiding and enriching.</p>
<hr>
<p>Previous:  <a href="API.html">The API</a>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
Up:  <a href="./">Index</a>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;
Next:  <a href="EventHandlingInfographic.html">Infographic Overview</a></p>
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<!-- END doctoc generated TOC please keep comment here to allow auto update -->

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="API.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: The API">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Mental Model Omnibus","level":"2.5","depth":1,"next":{"title":"purelyfunctional.tv","level":"3.1","depth":1,"url":"https://purelyfunctional.tv/guide/re-frame-building-blocks/","ref":"https://purelyfunctional.tv/guide/re-frame-building-blocks/","articles":[]},"previous":{"title":"The API","level":"2.4","depth":1,"path":"API.md","ref":"API.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"root":"./docs/","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"README.md"},"variables":{},"title":"re-frame","language":"en","gitbook":"*","description":"Documentation of re-frame framework"},"file":{"path":"MentalModelOmnibus.md","mtime":"2017-09-21T10:24:52.725Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-09-21T10:34:13.106Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

